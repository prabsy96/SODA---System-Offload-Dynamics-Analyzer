# SODA â€” System-Offload-Dynamics-Analyzer

[![CI](https://github.com/prabsy96/soda/actions/workflows/ci.yml/badge.svg)](https://github.com/prabsy96/soda/actions/workflows/ci.yml)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
![Python 3.9+](https://img.shields.io/badge/python-3.9+-blue.svg)

SODA is a lightweight tool for analyzing the system-level performance dynamics of PyTorch models. It captures and dissects CPU-GPU interactions during model inference, providing insights into kernel launch overhead, execution dependencies, and opportunities for operator fusion. It is a minimal, simplified variant inspired by the in-depth analysis of the **SKIP** tool.

### 1. Overview

SODA helps developers and researchers quickly profile their models to understand performance bottlenecks that are not obvious from high-level latency numbers. By parsing the low-level traces generated by the PyTorch profiler, it quantifies metrics like CUDA runtime overhead, kernel execution time, and GPU idle time, making it easier to identify areas for optimization.

### 2. Background & Prior Work

This tool is derived from and directly inspired by the research presented in the following paper:

> *Characterizing and Optimizing LLM Inference Workloads on CPU-GPU Coupled Architectures*. [Prabhu Vellaisamy, Thomas Labonte, Sourav Chakraborty, Matthew Turner, Samantika Sury, John Paul Shen] ISPASS 2025. 

Please cite as *P. Vellaisamy, T. Labonte, S. Chakraborty, M. Turner, S. Sury and J. P. Shen, "Characterizing and Optimizing LLM Inference Workloads on CPU-GPU Coupled Architectures," 2025 IEEE International Symposium on Performance Analysis of Systems and Software (ISPASS), Ghent, Belgium, 2025, pp. 49-61, doi: 10.1109/ISPASS64960.2025.00015.*

## Installation

**Clone the repository:**
    ```bash
    git clone [https://github.com/your-username/soda.git](https://github.com/your-username/soda.git)
    cd soda
    ```
    pip install -r requirements.txt

## Quickstart

Run the analysis on a model (e.g., `gpt2`) using synthetic data. The following command will generate trace files and summary reports in the `soda_results/` directory.

```bash
# Run from the root of the repository
./examples/quickstart.sh